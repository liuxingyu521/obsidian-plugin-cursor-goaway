/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CursorGoaway
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var CursorGoaway = class extends import_obsidian.Plugin {
  async onload() {
    this.registerEvent(
      this.app.workspace.on("file-open", (file) => {
        let startTime;
        let isBlurring = false;
        const blurEditor = () => {
          var _a, _b;
          (_b = (_a = this.app.workspace.activeEditor) == null ? void 0 : _a.editor) == null ? void 0 : _b.blur();
          if (performance.now() - startTime < 500) {
            requestAnimationFrame(blurEditor);
          } else {
            isBlurring = false;
          }
        };
        this.cleanupKeydownHandler();
        if ((file == null ? void 0 : file.extension) === "md") {
          startTime = performance.now();
          isBlurring = true;
          requestAnimationFrame(blurEditor);
          const onKeyDown = (e) => {
            var _a;
            if (e.key !== "ArrowDown")
              return;
            const activeFile = this.app.workspace.getActiveFile();
            if ((activeFile == null ? void 0 : activeFile.path) !== file.path)
              return this.cleanupKeydownHandler();
            if (isBlurring)
              return;
            const editor = (_a = this.app.workspace.activeEditor) == null ? void 0 : _a.editor;
            if (editor) {
              const cm = editor.cm;
              if (cm && cm.hasFocus && cm.hasFocus()) {
                return this.cleanupKeydownHandler();
              }
            }
            const activeElement = document.activeElement;
            const editorContainer = activeElement == null ? void 0 : activeElement.closest(".cm-editor, .cm-content, .markdown-source-view");
            if (editorContainer) {
              return this.cleanupKeydownHandler();
            }
            e.preventDefault();
            if (editor) {
              try {
                editor.focus();
              } catch (err) {
                console.debug("focus() failed", err);
              }
              editor.setCursor(0, 0);
            }
            this.cleanupKeydownHandler();
          };
          document.addEventListener("keydown", onKeyDown, true);
          this.currentKeydownHandler = onKeyDown;
        }
      })
    );
  }
  /**
   * cleanup the keydown handler
   */
  cleanupKeydownHandler() {
    if (this.currentKeydownHandler) {
      document.removeEventListener("keydown", this.currentKeydownHandler, true);
      this.currentKeydownHandler = void 0;
    }
  }
  onunload() {
    this.cleanupKeydownHandler();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBFZGl0b3IgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEN1cnNvckdvYXdheSBleHRlbmRzIFBsdWdpbiB7XG5cdHByaXZhdGUgY3VycmVudEtleWRvd25IYW5kbGVyPzogKGU6IEtleWJvYXJkRXZlbnQpID0+IHZvaWQ7XG5cdFxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdmaWxlLW9wZW4nLCAoZmlsZSkgPT4ge1xuXHRcdFx0XHRsZXQgc3RhcnRUaW1lOiBudW1iZXI7XG5cdFx0XHRcdGxldCBpc0JsdXJyaW5nID0gZmFsc2U7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zdCBibHVyRWRpdG9yID0gKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVFZGl0b3I/LmVkaXRvcj8uYmx1cigpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZSA8IDUwMCkge1xuXHRcdFx0XHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKGJsdXJFZGl0b3IpXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlzQmx1cnJpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBBbHdheXMgY2xlYW51cCBhbnkgcHJldmlvdXMgb25lLXRpbWUgaGFuZGxlciB3aGVuIG9wZW5pbmcgYSBuZXcgZmlsZVxuXHRcdFx0XHR0aGlzLmNsZWFudXBLZXlkb3duSGFuZGxlcigpO1xuXG5cdFx0XHRcdC8vIHdoZW4gdG9nZ2xlIHRvIHRoZSBtZCBmaWxlLCBibHVyIHRoZSBwYWdlIGluIDUwMG1zIHRvIGF2b2lkIGJyZWFrIHRoZSBwcmV2aWV3IHN0eWxlXHRcblx0XHRcdFx0aWYgKGZpbGU/LmV4dGVuc2lvbiA9PT0gJ21kJykge1xuXHRcdFx0XHRcdHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXHRcdFx0XHRcdGlzQmx1cnJpbmcgPSB0cnVlO1xuXHRcdFx0XHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZShibHVyRWRpdG9yKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjb25zdCBvbktleURvd24gPSAoZTogS2V5Ym9hcmRFdmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0aWYgKGUua2V5ICE9PSAnQXJyb3dEb3duJykgcmV0dXJuO1xuXHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdFx0XHQvLyBPbmx5IHJlYWN0IGlmIHRoZSBzYW1lIGZpbGUgaXMgc3RpbGwgYWN0aXZlXG5cdFx0XHRcdFx0XHRpZiAoYWN0aXZlRmlsZT8ucGF0aCAhPT0gZmlsZS5wYXRoKSByZXR1cm4gdGhpcy5jbGVhbnVwS2V5ZG93bkhhbmRsZXIoKTtcblx0XHRcdFx0XHRcdC8vIElnbm9yZSBBcnJvd0Rvd24gd2hpbGUgYmx1ciBjeWNsZSBpcyBhY3RpdmVcblx0XHRcdFx0XHRcdGlmIChpc0JsdXJyaW5nKSByZXR1cm47XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIGVkaXRvciBhbHJlYWR5IGhhcyBmb2N1cyAodXNlciBpcyBhbHJlYWR5IGVkaXRpbmcpXG5cdFx0XHRcdFx0XHRjb25zdCBlZGl0b3IgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlRWRpdG9yPy5lZGl0b3IgYXMgRWRpdG9yIHwgdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0aWYgKGVkaXRvcikge1xuXHRcdFx0XHRcdFx0XHQvLyBUcnkgdG8gYWNjZXNzIHRoZSBDb2RlTWlycm9yIGluc3RhbmNlIHRvIGNoZWNrIGZvY3VzIHN0YXRlXG5cdFx0XHRcdFx0XHRcdC8vIEB0cy1pZ25vcmUgLSBhY2Nlc3NpbmcgaW50ZXJuYWwgY20gcHJvcGVydHlcblx0XHRcdFx0XHRcdFx0Y29uc3QgY20gPSBlZGl0b3IuY207XG5cdFx0XHRcdFx0XHRcdGlmIChjbSAmJiBjbS5oYXNGb2N1cyAmJiBjbS5oYXNGb2N1cygpKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gRWRpdG9yIGFscmVhZHkgaGFzIGZvY3VzLCBkb24ndCBqdW1wIHRvIHRvcFxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB0aGlzLmNsZWFudXBLZXlkb3duSGFuZGxlcigpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIEZhbGxiYWNrOiBjaGVjayBpZiBhY3RpdmVFbGVtZW50IGlzIHdpdGhpbiB0aGUgZWRpdG9yIGNvbnRhaW5lclxuXHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cdFx0XHRcdFx0XHRjb25zdCBlZGl0b3JDb250YWluZXIgPSBhY3RpdmVFbGVtZW50Py5jbG9zZXN0KCcuY20tZWRpdG9yLCAuY20tY29udGVudCwgLm1hcmtkb3duLXNvdXJjZS12aWV3Jyk7XG5cdFx0XHRcdFx0XHRpZiAoZWRpdG9yQ29udGFpbmVyKSB7XG5cdFx0XHRcdFx0XHRcdC8vIEVkaXRvciBhbHJlYWR5IGZvY3VzZWQsIGRvbid0IGp1bXAgdG8gdG9wXG5cdFx0XHRcdFx0XHRcdHJldHVybiB0aGlzLmNsZWFudXBLZXlkb3duSGFuZGxlcigpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBFZGl0b3Igbm90IGZvY3VzZWQgeWV0LCBqdW1wIHRvIHRvcCBhbmQgZm9jdXNcblx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0XHRcdFx0dHJ5IHsgZWRpdG9yLmZvY3VzKCk7IH0gY2F0Y2ggKGVycikgeyBjb25zb2xlLmRlYnVnKCdmb2N1cygpIGZhaWxlZCcsIGVycik7IH1cblx0XHRcdFx0XHRcdFx0ZWRpdG9yLnNldEN1cnNvcigwLCAwKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHRoaXMuY2xlYW51cEtleWRvd25IYW5kbGVyKCk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgb25LZXlEb3duLCB0cnVlKTtcblx0XHRcdFx0XHR0aGlzLmN1cnJlbnRLZXlkb3duSGFuZGxlciA9IG9uS2V5RG93bjtcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHQpXG5cdFx0XG5cdH1cblxuXHQvKipcblx0ICogY2xlYW51cCB0aGUga2V5ZG93biBoYW5kbGVyXG5cdCAqL1xuXHRjbGVhbnVwS2V5ZG93bkhhbmRsZXIoKSB7XG5cdFx0aWYgKHRoaXMuY3VycmVudEtleWRvd25IYW5kbGVyKSB7XG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5jdXJyZW50S2V5ZG93bkhhbmRsZXIsIHRydWUpO1xuXHRcdFx0dGhpcy5jdXJyZW50S2V5ZG93bkhhbmRsZXIgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHR9XG5cblx0b251bmxvYWQoKSB7XG5cdFx0dGhpcy5jbGVhbnVwS2V5ZG93bkhhbmRsZXIoKTtcblx0fVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUErQjtBQUUvQixJQUFxQixlQUFyQixjQUEwQyx1QkFBTztBQUFBLEVBR2hELE1BQU0sU0FBUztBQUNkLFNBQUs7QUFBQSxNQUNKLEtBQUssSUFBSSxVQUFVLEdBQUcsYUFBYSxDQUFDLFNBQVM7QUFDNUMsWUFBSTtBQUNKLFlBQUksYUFBYTtBQUVqQixjQUFNLGFBQWEsTUFBTTtBQVg3QjtBQVlLLDJCQUFLLElBQUksVUFBVSxpQkFBbkIsbUJBQWlDLFdBQWpDLG1CQUF5QztBQUV6QyxjQUFJLFlBQVksSUFBSSxJQUFJLFlBQVksS0FBSztBQUN4QyxrQ0FBc0IsVUFBVTtBQUFBLFVBQ2pDLE9BQU87QUFDTix5QkFBYTtBQUFBLFVBQ2Q7QUFBQSxRQUNEO0FBR0EsYUFBSyxzQkFBc0I7QUFHM0IsYUFBSSw2QkFBTSxlQUFjLE1BQU07QUFDN0Isc0JBQVksWUFBWSxJQUFJO0FBQzVCLHVCQUFhO0FBQ2IsZ0NBQXNCLFVBQVU7QUFFaEMsZ0JBQU0sWUFBWSxDQUFDLE1BQXFCO0FBOUI3QztBQStCTSxnQkFBSSxFQUFFLFFBQVE7QUFBYTtBQUMzQixrQkFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFFcEQsaUJBQUkseUNBQVksVUFBUyxLQUFLO0FBQU0scUJBQU8sS0FBSyxzQkFBc0I7QUFFdEUsZ0JBQUk7QUFBWTtBQUdoQixrQkFBTSxVQUFTLFVBQUssSUFBSSxVQUFVLGlCQUFuQixtQkFBaUM7QUFDaEQsZ0JBQUksUUFBUTtBQUdYLG9CQUFNLEtBQUssT0FBTztBQUNsQixrQkFBSSxNQUFNLEdBQUcsWUFBWSxHQUFHLFNBQVMsR0FBRztBQUV2Qyx1QkFBTyxLQUFLLHNCQUFzQjtBQUFBLGNBQ25DO0FBQUEsWUFDRDtBQUdBLGtCQUFNLGdCQUFnQixTQUFTO0FBQy9CLGtCQUFNLGtCQUFrQiwrQ0FBZSxRQUFRO0FBQy9DLGdCQUFJLGlCQUFpQjtBQUVwQixxQkFBTyxLQUFLLHNCQUFzQjtBQUFBLFlBQ25DO0FBR0EsY0FBRSxlQUFlO0FBQ2pCLGdCQUFJLFFBQVE7QUFDWCxrQkFBSTtBQUFFLHVCQUFPLE1BQU07QUFBQSxjQUFHLFNBQVMsS0FBUDtBQUFjLHdCQUFRLE1BQU0sa0JBQWtCLEdBQUc7QUFBQSxjQUFHO0FBQzVFLHFCQUFPLFVBQVUsR0FBRyxDQUFDO0FBQUEsWUFDdEI7QUFDQSxpQkFBSyxzQkFBc0I7QUFBQSxVQUM1QjtBQUNBLG1CQUFTLGlCQUFpQixXQUFXLFdBQVcsSUFBSTtBQUNwRCxlQUFLLHdCQUF3QjtBQUFBLFFBQzlCO0FBQUEsTUFDRCxDQUFDO0FBQUEsSUFDRjtBQUFBLEVBRUQ7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLHdCQUF3QjtBQUN2QixRQUFJLEtBQUssdUJBQXVCO0FBQy9CLGVBQVMsb0JBQW9CLFdBQVcsS0FBSyx1QkFBdUIsSUFBSTtBQUN4RSxXQUFLLHdCQUF3QjtBQUFBLElBQzlCO0FBQUEsRUFDRDtBQUFBLEVBRUEsV0FBVztBQUNWLFNBQUssc0JBQXNCO0FBQUEsRUFDNUI7QUFDRDsiLAogICJuYW1lcyI6IFtdCn0K
